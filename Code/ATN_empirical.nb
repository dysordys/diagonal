(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 9.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       157,          7]
NotebookDataLength[     43618,       1001]
NotebookOptionsPosition[     42785,        976]
NotebookOutlinePosition[     43140,        992]
CellTagsIndexPosition[     43097,        989]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{"ClearAll", "[", "\"\<Global`*\>\"", "]"}]], "Input",
 CellChangeTimes->{{3.605027844351396*^9, 3.605027851492716*^9}, {
  3.61159529109028*^9, 3.611595291728547*^9}, {3.611662512311323*^9, 
  3.611662512518653*^9}, {3.61435940836519*^9, 3.6143594086164637`*^9}, {
  3.614359828642439*^9, 3.614359829413526*^9}, {3.631140745520158*^9, 
  3.631140746011443*^9}, {3.634496847151143*^9, 
  3.6344968473190107`*^9}},ExpressionUUID->"ac66ce40-ddf3-434d-8340-\
5be3f0c2f5b0"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "Smoothed", " ", "sigmoid", " ", "function", " ", "to", " ", "prevent", 
     " ", "negative", " ", "values", " ", "during", " ", "numerical", " ", 
     RowBox[{"integration", ".", " ", 
      RowBox[{"Inputs", ":", " ", 
       RowBox[{
       "the", " ", "independent", " ", "variable", " ", "representing", " ", 
        "one", " ", "of", " ", "the", " ", "dynamical", " ", "variables", " ", 
        RowBox[{"(", "n", ")"}]}]}]}]}], ",", " ", 
    RowBox[{
    "and", " ", "the", " ", "threshold", " ", "at", " ", "which", " ", "the", 
     " ", "function", " ", "starts", " ", "declining", " ", 
     RowBox[{
      RowBox[{"(", "a", ")"}], ".", " ", 
      RowBox[{"Output", ":", " ", 
       RowBox[{
       "a", " ", "function", " ", "which", " ", "is", " ", "zero", " ", "for",
         " ", "negative", " ", "values", " ", "of", " ", "the", " ", 
        "argument", " ", "n"}]}]}]}], ",", " ", 
    RowBox[{
     RowBox[{"one", " ", "for", " ", "n"}], " ", ">", " ", "a"}], ",", " ", 
    RowBox[{
    "and", " ", "changes", " ", "cubically", " ", "in", " ", "between", " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
       "its", " ", "first", " ", "derivative", " ", "is", " ", "continuous", 
        " ", "everywhere"}], ")"}], "."}]}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"cutoff", "[", 
     RowBox[{"n_", ",", "a_"}], "]"}], ":=", 
    RowBox[{"Piecewise", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"3", "*", 
           RowBox[{
            RowBox[{"n", "^", "2"}], "/", 
            RowBox[{"a", "^", "2"}]}]}], "-", 
          RowBox[{"2", "*", 
           RowBox[{
            RowBox[{"n", "^", "3"}], "/", 
            RowBox[{"a", "^", "3"}]}]}]}], ",", 
         RowBox[{"0", "\[LessEqual]", "n", "\[LessEqual]", "a"}]}], "}"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", 
         RowBox[{"n", ">", "a"}]}], "}"}]}], "}"}], "]"}]}], ";"}]}]], "Input",\

 CellChangeTimes->{{3.706509496225368*^9, 3.706509502120502*^9}, {
  3.706512496800362*^9, 3.7065126280311737`*^9}, {3.706512702327862*^9, 
  3.706512710166849*^9}},ExpressionUUID->"4b2d2b42-172f-43da-b9e3-\
ef92b324b14b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "Integrate", " ", "the", " ", "allometric", " ", "trophic", " ", 
     "network", " ", "model", " ", "with", " ", "given", " ", 
     RowBox[{"parameters", ".", " ", 
      RowBox[{"Input", ":", " ", 
       RowBox[{"the", " ", "adjacency", " ", "matrix", " ", "w"}]}]}]}], ",", 
    " ", 
    RowBox[{"intrinsic", " ", "growth", " ", "rates", " ", "r"}], ",", " ", 
    RowBox[{"metabolic", " ", "rates", " ", "x"}], ",", " ", 
    RowBox[{
    "maximum", " ", "relative", " ", "consumption", " ", "rate", " ", "y"}], 
    ",", " ", 
    RowBox[{"assimilarion", " ", "efficiencies", " ", "e"}], ",", " ", 
    RowBox[{
    "proportion", " ", "of", " ", "consumption", " ", "effort", " ", 
     "targeted", " ", "at", " ", "prey", " ", "\[Omega]"}], ",", " ", 
    RowBox[{"the", " ", "Hill", " ", "exponent", " ", "h"}], ",", " ", 
    RowBox[{"saturation", " ", "constant", " ", "bnaught"}], ",", " ", 
    RowBox[{"half", "-", 
     RowBox[{
     "saturation", " ", "densities", " ", "for", " ", "the", " ", "nutrients",
       " ", "k"}]}], ",", " ", 
    RowBox[{"nutrient", " ", "turnover", " ", "rate", " ", "d"}], ",", " ", 
    RowBox[{"nutrient", " ", "supply", " ", "rates", " ", "s"}], ",", " ", 
    RowBox[{"nutrient", " ", "consumption", " ", "rates", " ", "c"}], ",", 
    " ", 
    RowBox[{"initial", " ", "conditions", " ", "for", " ", "species", " ", 
     RowBox[{"(", "b0", ")"}], " ", "and", " ", "nutrients", " ", 
     RowBox[{"(", "n0", ")"}]}], ",", " ", 
    RowBox[{
    "and", " ", "the", " ", "time", " ", "to", " ", "integrate", " ", "the", 
     " ", "equations", " ", "for", " ", 
     RowBox[{
      RowBox[{"(", "tmax", ")"}], ".", " ", 
      RowBox[{"Output", ":", " ", 
       RowBox[{
       "time", " ", "series", " ", "for", " ", "all", " ", "species", " ", 
        "and", " ", 
        RowBox[{"nutrients", "."}]}]}]}]}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"solveATN", "[", 
     RowBox[{
     "w_List", ",", "r_List", ",", "x_List", ",", "y_", ",", "e_List", ",", 
      "\[Omega]_List", ",", "h_", ",", "bnaught_", ",", "k_List", ",", "d_", 
      ",", "s_List", ",", "c_List", ",", "b0_List", ",", "n0_List", ",", 
      "tmax_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "vars", ",", "eqb", ",", "eqn", ",", "equations", ",", "sol", ",", "b",
         ",", "n", ",", "sb", ",", "sn", ",", "sp", ",", "t", ",", "g", ",", 
        "f"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"sb", "=", 
        RowBox[{"Length", "[", "b0", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"sn", "=", 
        RowBox[{"Length", "[", "n0", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"sp", "=", 
        RowBox[{"Count", "[", 
         RowBox[{"\[Omega]", ",", 
          RowBox[{"Table", "[", 
           RowBox[{"0", ",", 
            RowBox[{"{", "sb", "}"}]}], "]"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"g", "[", "i_", "]"}], ":=", 
        RowBox[{"Min", "[", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"n", "[", "j", "]"}], "[", "t", "]"}], "/", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"k", "\[LeftDoubleBracket]", 
               RowBox[{"j", ",", "i"}], "\[RightDoubleBracket]"}], "+", 
              RowBox[{
               RowBox[{"n", "[", "j", "]"}], "[", "t", "]"}]}], ")"}]}], ",", 
           
           RowBox[{"{", 
            RowBox[{"j", ",", "1", ",", "sn"}], "}"}]}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"f", "[", 
         RowBox[{"i_", ",", "j_"}], "]"}], ":=", 
        RowBox[{
         RowBox[{"\[Omega]", "\[LeftDoubleBracket]", 
          RowBox[{"i", ",", "j"}], "\[RightDoubleBracket]"}], "*", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"b", "[", "j", "]"}], "[", "t", "]"}], ")"}], "^", 
            "h"}], ")"}], "/", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"bnaught", "^", "h"}], "+", 
            RowBox[{"Sum", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"w", "\[LeftDoubleBracket]", 
                RowBox[{"i", ",", "l"}], "\[RightDoubleBracket]"}], "*", 
               RowBox[{"\[Omega]", "\[LeftDoubleBracket]", 
                RowBox[{"i", ",", "l"}], "\[RightDoubleBracket]"}], "*", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"b", "[", "l", "]"}], "[", "t", "]"}], ")"}], "^", 
                "h"}]}], ",", 
              RowBox[{"{", 
               RowBox[{"l", ",", "1", ",", "sb"}], "}"}]}], "]"}]}], 
           ")"}]}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"vars", "=", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"b", "[", "i", "]"}], "[", "t", "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", "sb"}], "}"}]}], "]"}], ",", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"n", "[", "i", "]"}], "[", "t", "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", "sn"}], "}"}]}], "]"}]}], "]"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"eqb", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"b", "[", "i", "]"}], "'"}], "[", "t", "]"}], 
             "\[Equal]", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                  "r", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}],
                   "*", 
                  RowBox[{"g", "[", "i", "]"}], "*", 
                  RowBox[{
                   RowBox[{"b", "[", "i", "]"}], "[", "t", "]"}]}], "-", 
                 RowBox[{
                  RowBox[{
                  "x", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}],
                   "*", 
                  RowBox[{
                   RowBox[{"b", "[", "i", "]"}], "[", "t", "]"}]}], "+", 
                 RowBox[{"Sum", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{"w", "\[LeftDoubleBracket]", 
                    RowBox[{"i", ",", "j"}], "\[RightDoubleBracket]"}], "*", 
                    RowBox[{
                    "x", "\[LeftDoubleBracket]", "i", 
                    "\[RightDoubleBracket]"}], "*", "y", "*", 
                    RowBox[{
                    RowBox[{"b", "[", "i", "]"}], "[", "t", "]"}], "*", 
                    RowBox[{"f", "[", 
                    RowBox[{"i", ",", "j"}], "]"}]}], "-", 
                    RowBox[{
                    RowBox[{"w", "\[LeftDoubleBracket]", 
                    RowBox[{"j", ",", "i"}], "\[RightDoubleBracket]"}], "*", 
                    RowBox[{
                    "x", "\[LeftDoubleBracket]", "j", 
                    "\[RightDoubleBracket]"}], "*", "y", "*", 
                    RowBox[{
                    RowBox[{"b", "[", "j", "]"}], "[", "t", "]"}], "*", 
                    RowBox[{
                    RowBox[{"f", "[", 
                    RowBox[{"j", ",", "i"}], "]"}], "/", 
                    RowBox[{"e", "\[LeftDoubleBracket]", 
                    RowBox[{"j", ",", "i"}], "\[RightDoubleBracket]"}]}]}]}], 
                   ",", 
                   RowBox[{"{", 
                    RowBox[{"j", ",", "1", ",", "sb"}], "}"}]}], "]"}]}], 
                ")"}], ")"}], "*", 
              RowBox[{"cutoff", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"b", "[", "i", "]"}], "[", "t", "]"}], ",", 
                RowBox[{"10.0", "^", 
                 RowBox[{"(", 
                  RowBox[{"-", "10.0"}], ")"}]}]}], "]"}]}]}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"b", "[", "i", "]"}], "[", "0", "]"}], "\[Equal]", 
             RowBox[{
             "b0", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}]}]}],
            "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", "sb"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"eqn", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"n", "[", "l", "]"}], "'"}], "[", "t", "]"}], 
             "\[Equal]", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"d", "*", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    "s", "\[LeftDoubleBracket]", "l", 
                    "\[RightDoubleBracket]"}], "-", 
                    RowBox[{
                    RowBox[{"n", "[", "l", "]"}], "[", "t", "]"}]}], ")"}]}], 
                 "-", 
                 RowBox[{"Sum", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"c", "\[LeftDoubleBracket]", 
                    RowBox[{"l", ",", "i"}], "\[RightDoubleBracket]"}], "*", 
                    RowBox[{
                    "r", "\[LeftDoubleBracket]", "i", 
                    "\[RightDoubleBracket]"}], "*", 
                    RowBox[{"g", "[", "i", "]"}], "*", 
                    RowBox[{
                    RowBox[{"b", "[", "i", "]"}], "[", "t", "]"}]}], ",", 
                   RowBox[{"{", 
                    RowBox[{"i", ",", "1", ",", "sb"}], "}"}]}], "]"}]}], 
                ")"}], ")"}], "*", 
              RowBox[{"cutoff", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"n", "[", "l", "]"}], "[", "t", "]"}], ",", 
                RowBox[{"10.0", "^", 
                 RowBox[{"(", 
                  RowBox[{"-", "10.0"}], ")"}]}]}], "]"}]}]}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"n", "[", "l", "]"}], "[", "0", "]"}], "\[Equal]", 
             RowBox[{
             "n0", "\[LeftDoubleBracket]", "l", "\[RightDoubleBracket]"}]}]}],
            "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"l", ",", "1", ",", "sn"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"equations", "=", 
        RowBox[{"Join", "[", 
         RowBox[{"eqb", ",", "eqn"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"sol", "=", 
        RowBox[{"NDSolve", "[", 
         RowBox[{"equations", ",", 
          RowBox[{"Join", "[", 
           RowBox[{
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"b", "[", "i", "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", "1", ",", "sb"}], "}"}]}], "]"}], ",", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"n", "[", "i", "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", "1", ",", "sn"}], "}"}]}], "]"}]}], "]"}], 
          ",", 
          RowBox[{"{", 
           RowBox[{"t", ",", "0", ",", "tmax"}], "}"}], ",", 
          RowBox[{"MaxSteps", "\[Rule]", "Infinity"}], ",", 
          RowBox[{"DependentVariables", "\[Rule]", "vars"}], ",", 
          RowBox[{"Method", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
            "\"\<EquationSimplification\>\"", "\[Rule]", "\"\<Residual\>\""}],
             "}"}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Return", "[", 
        RowBox[{"Flatten", "[", 
         RowBox[{
          RowBox[{"Join", "[", 
           RowBox[{
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"b", "[", "i", "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", "1", ",", "sb"}], "}"}]}], "]"}], ",", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"n", "[", "i", "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", "1", ",", "sn"}], "}"}]}], "]"}]}], "]"}], "/.",
           "sol"}], "]"}], "]"}], ";"}]}], "\[IndentingNewLine]", "]"}]}], 
   ";"}]}]], "Input",
 CellChangeTimes->{{3.604164903135532*^9, 3.6041649139557753`*^9}, 
   3.604231181666267*^9, {3.604321296711308*^9, 3.604321301172612*^9}, {
   3.6043213935857*^9, 3.6043213961226788`*^9}, 3.604321502606097*^9, {
   3.604321840775981*^9, 3.604321847544588*^9}, {3.604321926553396*^9, 
   3.604321930654077*^9}, {3.604322159862033*^9, 3.604322159920795*^9}, {
   3.6060608257815323`*^9, 3.6060608264177856`*^9}, 3.6060619962094173`*^9, {
   3.6115970790542*^9, 3.611597100090762*^9}, {3.6118397750762453`*^9, 
   3.611839777379937*^9}, {3.611916235669464*^9, 3.611916238135915*^9}, {
   3.613393892525324*^9, 3.6133938929942923`*^9}, {3.613394736331127*^9, 
   3.613394738905932*^9}, {3.63111390245223*^9, 3.631113918139227*^9}, {
   3.631114025786243*^9, 3.631114053002476*^9}, {3.631114193651232*^9, 
   3.631114194169428*^9}, {3.631115020446418*^9, 3.631115024136907*^9}, {
   3.631115522895591*^9, 3.631115547655975*^9}, {3.631140363659333*^9, 
   3.631140365724604*^9}, {3.631140534175586*^9, 3.631140550276554*^9}, {
   3.631140679572703*^9, 3.631140688953632*^9}, {3.6344963363063097`*^9, 
   3.634496340420347*^9}, {3.6344981994742603`*^9, 3.6344982524887743`*^9}, {
   3.634498320220984*^9, 3.634498341998856*^9}, {3.7059876195999727`*^9, 
   3.7059876429821157`*^9}, {3.7059878178457327`*^9, 
   3.7059879006768103`*^9}, {3.705987966020411*^9, 3.705988016907667*^9}, 
   3.705988255499753*^9, {3.705988510012363*^9, 3.705988514262651*^9}, {
   3.705996373860614*^9, 3.705996418615366*^9}, {3.705996495762629*^9, 
   3.705996522015594*^9}, {3.706414905536683*^9, 3.7064149155751467`*^9}, {
   3.706438254265828*^9, 3.706438281264189*^9}, {3.7064392083067513`*^9, 
   3.706439208956471*^9}, {3.706439556210589*^9, 3.706439826103901*^9}, {
   3.70649989541002*^9, 3.706499902505018*^9}, {3.70650951936242*^9, 
   3.706509581858445*^9}, {3.706512810106041*^9, 
   3.706512811137293*^9}},ExpressionUUID->"e4b5a597-cb9e-4611-89bb-\
5b4e0b2e6fa4"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
  "path", "=", "\"\<EmpiricalWebs/Data_with_bodymasses/carpinteria/\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"w", "=", 
   RowBox[{"Import", "[", 
    RowBox[{
     RowBox[{"path", "<>", "\"\<data.txt\>\""}], ",", "\"\<Table\>\""}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"bodymass", "=", 
   RowBox[{"Flatten", "[", 
    RowBox[{"Import", "[", 
     RowBox[{
      RowBox[{"path", "<>", "\"\<bodymass.txt\>\""}], ",", "\"\<Table\>\""}], 
     "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"S", "=", 
   RowBox[{"Length", "[", "bodymass", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Sn", "=", "10"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"reps", "=", "100"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"numsp", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"0", ",", 
     RowBox[{"{", "reps", "}"}]}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.706499568377172*^9, 3.706499673751932*^9}, {
   3.7065124033277073`*^9, 3.7065124493042192`*^9}, {3.706512728999601*^9, 
   3.7065127405267057`*^9}, {3.70651298095919*^9, 3.706512981070064*^9}, {
   3.706603593762141*^9, 3.706603634344697*^9}, {3.70660370041719*^9, 
   3.706603701392247*^9}, {3.706954677922636*^9, 3.706954678280607*^9}, {
   3.707812311507306*^9, 3.707812342257874*^9}, 3.707812388506063*^9, {
   3.70781245231399*^9, 3.707812455120968*^9}, {3.707812564617516*^9, 
   3.707812575777637*^9}},ExpressionUUID->"9ed0a9ae-697e-4614-8c9b-\
557ac14e715c"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"SeedRandom", "[", "54321", "]"}], ";"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{
   "Set", " ", "random", " ", "seed", " ", "for", " ", "reproducibility"}], 
   " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"\[Omega]", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"Sum", "[", 
         RowBox[{
          RowBox[{"w", "\[LeftDoubleBracket]", 
           RowBox[{"i", ",", "j"}], "\[RightDoubleBracket]"}], ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", "1", ",", "S"}], "}"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "S"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "1", ",", "S"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"\[Omega]", "\[LeftDoubleBracket]", 
           RowBox[{"i", ",", "j"}], "\[RightDoubleBracket]"}], "\[NotEqual]", 
          "0"}], ",", 
         RowBox[{
          RowBox[{"\[Omega]", "\[LeftDoubleBracket]", 
           RowBox[{"i", ",", "j"}], "\[RightDoubleBracket]"}], "=", 
          RowBox[{"1", "/", 
           RowBox[{"\[Omega]", "\[LeftDoubleBracket]", 
            RowBox[{"i", ",", "j"}], "\[RightDoubleBracket]"}]}]}]}], "]"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "S"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "1", ",", "S"}], "}"}]}], "]"}], " ", ";", " ", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"\[Omega]", "\[LeftDoubleBracket]", 
        RowBox[{"i", ",", "j"}], "\[RightDoubleBracket]"}], ":", " ", 
       RowBox[{"proportion", " ", "of", " ", 
        RowBox[{"i", "'"}], "s", " ", "maximum", " ", "consumption", " ", 
        "rate", " ", "targeted", " ", "at", " ", "consuming", " ", "j"}]}], 
      " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"r", "=", 
      RowBox[{"Table", "[", 
       RowBox[{"0", ",", 
        RowBox[{"{", "S", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"r", "\[LeftDoubleBracket]", 
       RowBox[{"Flatten", "[", 
        RowBox[{"Position", "[", 
         RowBox[{"\[Omega]", ",", 
          RowBox[{"Table", "[", 
           RowBox[{"0", ",", 
            RowBox[{"{", "S", "}"}]}], "]"}]}], "]"}], "]"}], 
       "\[RightDoubleBracket]"}], "=", "1.0"}], ";", " ", 
     RowBox[{"(*", " ", 
      RowBox[{"Intrinsic", " ", "growth", " ", 
       RowBox[{"rates", ":", " ", 
        RowBox[{
        "1", " ", "for", " ", "producers", " ", "and", " ", "0", " ", 
         "otherwise"}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"A", "=", "w"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Do", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Sum", "[", 
           RowBox[{
            RowBox[{"w", "\[LeftDoubleBracket]", 
             RowBox[{"i", ",", "l"}], "\[RightDoubleBracket]"}], ",", 
            RowBox[{"{", 
             RowBox[{"l", ",", "1", ",", "S"}], "}"}]}], "]"}], "\[NotEqual]",
           "0"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"A", "\[LeftDoubleBracket]", 
           RowBox[{"i", ",", "j"}], "\[RightDoubleBracket]"}], "=", 
          RowBox[{
           RowBox[{"w", "\[LeftDoubleBracket]", 
            RowBox[{"i", ",", "j"}], "\[RightDoubleBracket]"}], "/", 
           RowBox[{"Sum", "[", 
            RowBox[{
             RowBox[{"w", "\[LeftDoubleBracket]", 
              RowBox[{"i", ",", "l"}], "\[RightDoubleBracket]"}], ",", 
             RowBox[{"{", 
              RowBox[{"l", ",", "1", ",", "S"}], "}"}]}], "]"}]}]}]}], 
        "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "S"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "1", ",", "S"}], "}"}]}], "]"}], ";", " ", 
     RowBox[{"(*", " ", 
      RowBox[{
      "A", " ", "is", " ", "used", " ", "to", " ", "calculate", " ", "the", 
       " ", "trophic", " ", "levels", " ", "of", " ", "the", " ", "species", 
       " ", "using", " ", "the", " ", "Leontief", " ", "inverse"}], " ", 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{"tl", "=", 
      RowBox[{
       RowBox[{"Inverse", "[", 
        RowBox[{
         RowBox[{"IdentityMatrix", "[", "S", "]"}], "-", "A"}], "]"}], ".", 
       RowBox[{"Table", "[", 
        RowBox[{"1", ",", 
         RowBox[{"{", "S", "}"}]}], "]"}]}]}], ";", " ", 
     RowBox[{"(*", " ", 
      RowBox[{"Obtain", " ", "trophic", " ", "levels"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"Z", "=", 
      RowBox[{"RandomVariate", "[", 
       RowBox[{
        RowBox[{"LogNormalDistribution", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"2", "*", 
            RowBox[{"Log", "[", "10", "]"}]}], "-", 
           RowBox[{
            RowBox[{"Log", "[", "200", "]"}], "/", "2"}]}], ",", 
          RowBox[{"Sqrt", "[", 
           RowBox[{"Log", "[", "2", "]"}], "]"}]}], "]"}], ",", 
        RowBox[{"{", "S", "}"}]}], "]"}]}], ";", " ", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"Generate", " ", "vector"}], ",", " ", 
       RowBox[{
       "used", " ", "for", " ", "obtaining", " ", "body", " ", "masses"}]}], 
      " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"bodymass", "=", 
      RowBox[{"Z", "^", 
       RowBox[{"(", 
        RowBox[{"tl", "-", "1"}], ")"}]}]}], ";", " ", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Get", " ", "body", " ", "mass", " ", "of", " ", "each", " ", 
       "species"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
          "tl", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
          "\[Equal]", "1"}], ",", 
         RowBox[{
          RowBox[{
          "bodymass", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
          "=", "1"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "S"}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"axar", "=", 
      RowBox[{"Table", "[", 
       RowBox[{"0.314", ",", 
        RowBox[{"{", "S", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
          "tl", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
          "\[Equal]", "1"}], ",", 
         RowBox[{
          RowBox[{
          "axar", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], "=",
           "0.138"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "S"}], "}"}]}], "]"}], ";", " ", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{
       "Ratio", " ", "of", " ", "two", " ", "metabolic", " ", "constants"}], 
       ",", " ", 
       RowBox[{
        RowBox[{"a", "[", "x", "]"}], " ", "and", " ", 
        RowBox[{"a", "[", "r", "]"}]}], ",", " ", 
       RowBox[{
       "equal", " ", "to", " ", "0.", " ", "138", " ", "for", " ", 
        "producers", " ", "and", " ", "0.314", " ", "otherwise"}]}], " ", 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{"x", "=", 
      RowBox[{"axar", "*", 
       RowBox[{"bodymass", "^", 
        RowBox[{"(", 
         RowBox[{"-", "0.25"}], ")"}]}]}]}], ";", " ", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Metabolically", " ", "scaled", " ", "mortality", " ", "rates"}], " ", 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{"y", "=", "8.0"}], ";", " ", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Maximum", " ", "consumption", " ", "rate", " ", "of", " ", "consumers",
        " ", "relative", " ", "to", " ", "metabolic", " ", "rate"}], " ", 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{"e", "=", 
      RowBox[{"Table", "[", 
       RowBox[{"0.85", ",", 
        RowBox[{"{", "S", "}"}], ",", 
        RowBox[{"{", "S", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
          "tl", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
          "\[Equal]", "2"}], ",", 
         RowBox[{
          RowBox[{"e", "\[LeftDoubleBracket]", 
           RowBox[{"i", ",", "All"}], "\[RightDoubleBracket]"}], "=", 
          "0.45"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "S"}], "}"}]}], "]"}], ";", " ", 
     RowBox[{"(*", " ", 
      RowBox[{"Species", " ", 
       RowBox[{"i", "'"}], "s", " ", "assimilation", " ", "efficiency", " ", 
       "when", " ", "ingesting", " ", "species", " ", "j"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"h", "=", "2"}], ";", " ", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Hill", " ", "exponent", " ", "for", " ", "functional", " ", 
       "response"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"bnaught", "=", "0.5"}], ";", " ", 
     RowBox[{"(*", " ", 
      RowBox[{"Saturation", " ", "constant"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"k", "=", 
      RowBox[{"RandomReal", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0.1", ",", "0.2"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"Sn", ",", "S"}], "}"}]}], "]"}]}], ";", " ", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"Species", " ", 
        RowBox[{"j", "'"}], "s", " ", "half"}], "-", 
       RowBox[{
       "saturation", " ", "density", " ", "for", " ", "nutrient", " ", 
        "i"}]}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"d", "=", "0.25"}], ";", " ", 
     RowBox[{"(*", " ", 
      RowBox[{"Nutrient", " ", "turnover", " ", "rate"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"s", "=", 
      RowBox[{"Table", "[", 
       RowBox[{"1.0", ",", 
        RowBox[{"{", "Sn", "}"}]}], "]"}]}], ";", " ", 
     RowBox[{"(*", " ", 
      RowBox[{"Nutrient", " ", "supply", " ", "rates"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"c", "=", 
      RowBox[{"RandomReal", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0.5", ",", " ", "1.0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"Sn", ",", "S"}], "}"}]}], "]"}]}], ";", " ", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Consumption", " ", "rate", " ", "of", " ", "nutrient", " ", "i", " ", 
       "by", " ", 
       RowBox[{"(", "producer", ")"}], " ", "species", " ", "j"}], " ", 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{"b0", "=", 
      RowBox[{"RandomVariate", "[", 
       RowBox[{
        RowBox[{"UniformDistribution", "[", 
         RowBox[{"{", 
          RowBox[{"0.05", ",", "0.2"}], "}"}], "]"}], ",", 
        RowBox[{"{", "S", "}"}]}], "]"}]}], ";", " ", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Initial", " ", "conditions", " ", "for", " ", "species", " ", 
       "biomasses"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"n0", "=", 
      RowBox[{"RandomVariate", "[", 
       RowBox[{
        RowBox[{"UniformDistribution", "[", 
         RowBox[{"{", 
          RowBox[{"0.05", ",", "0.2"}], "}"}], "]"}], ",", 
        RowBox[{"{", "Sn", "}"}]}], "]"}]}], ";", " ", 
     RowBox[{"(*", " ", 
      RowBox[{"Initial", " ", "conditions", " ", "for", " ", "nutrients"}], 
      " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"tmax", "=", "5000"}], ";", " ", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Number", " ", "of", " ", "time", " ", "units", " ", "to", " ", 
       "integrate", " ", "ODEs", " ", "for"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"v", "=", 
      RowBox[{"solveATN", "[", 
       RowBox[{
       "w", ",", "r", ",", "x", ",", "y", ",", "e", ",", "\[Omega]", ",", "h",
         ",", "bnaught", ",", "k", ",", "d", ",", "s", ",", "c", ",", "b0", 
        ",", "n0", ",", "tmax"}], "]"}]}], ";", " ", 
     RowBox[{"(*", " ", 
      RowBox[{"Integrate", " ", "the", " ", "ODEs"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"bfinal", "=", "b0"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
        "bfinal", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], "=", 
        RowBox[{
         RowBox[{"v", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
         "[", "tmax", "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "S"}], "}"}]}], "]"}], ";", " ", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Extract", " ", "biomasses", " ", "at", " ", "final", " ", "moment", 
       " ", "of", " ", "time"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
          "bfinal", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
          "<", 
          RowBox[{"10.0", "^", 
           RowBox[{"(", 
            RowBox[{"-", "10.0"}], ")"}]}]}], ",", 
         RowBox[{
          RowBox[{
          "bfinal", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
          "=", "0"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "S"}], "}"}]}], "]"}], ";", " ", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{
       "Kill", " ", "off", " ", "species", " ", "which", " ", "fell", " ", 
        "below", " ", "the", " ", "extinction", " ", "threshold", " ", "of", 
        " ", "1", "E"}], "-", "10"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"pos", "=", 
      RowBox[{"Flatten", "[", 
       RowBox[{"Position", "[", 
        RowBox[{"bfinal", ",", 
         RowBox[{"x_", "/;", 
          RowBox[{"x", ">", "0"}]}]}], "]"}], "]"}]}], ";", " ", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Indices", " ", "of", " ", "the", " ", "positions", " ", "of", " ", 
       "the", " ", "surviving", " ", "species", " ", "in", " ", "bfinal"}], 
      " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"nfinal", "=", "n0"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
        "nfinal", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], "=", 
        RowBox[{
         RowBox[{"v", "\[LeftDoubleBracket]", 
          RowBox[{"i", "+", "S"}], "\[RightDoubleBracket]"}], "[", "tmax", 
         "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "Sn"}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Extract", " ", "final", " ", "nutrient", " ", "concentrations"}], " ", 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
      "numsp", "\[LeftDoubleBracket]", "rep", "\[RightDoubleBracket]"}], "=", 
      
      RowBox[{"Length", "[", "pos", "]"}]}], ";"}], "\[IndentingNewLine]", 
    ",", 
    RowBox[{"{", 
     RowBox[{"rep", ",", "1", ",", "reps"}], "}"}]}], "\[IndentingNewLine]", 
   "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.605028829966906*^9, 3.6050288946157217`*^9}, {
   3.605028924908683*^9, 3.605028989291356*^9}, {3.605029294185573*^9, 
   3.6050293103862667`*^9}, {3.605033193073913*^9, 3.605033209931169*^9}, {
   3.606585331666358*^9, 3.6065853936553583`*^9}, {3.6065854460098057`*^9, 
   3.606585467464964*^9}, {3.6065858470175543`*^9, 3.606585847112981*^9}, {
   3.6065859460481873`*^9, 3.606585967741888*^9}, {3.6065860687016087`*^9, 
   3.606586068773941*^9}, {3.6065861985598097`*^9, 3.606586250208693*^9}, {
   3.606586312281221*^9, 3.606586312632614*^9}, {3.606586355059181*^9, 
   3.606586437855966*^9}, {3.606587338294015*^9, 3.6065873478839817`*^9}, 
   3.606587587756551*^9, {3.610881848618589*^9, 3.610881882191394*^9}, {
   3.610883631168339*^9, 3.6108836312819138`*^9}, {3.6108843118376713`*^9, 
   3.610884329150559*^9}, {3.610884710183707*^9, 3.610884748907*^9}, {
   3.610884779568316*^9, 3.610884779687895*^9}, {3.6108848325386953`*^9, 
   3.610884832750616*^9}, {3.610884990963161*^9, 3.61088501947198*^9}, {
   3.6108850741093197`*^9, 3.610885074515435*^9}, {3.61142494117235*^9, 
   3.61142494154821*^9}, {3.6114250025707283`*^9, 3.611425017996456*^9}, 
   3.611425086313181*^9, {3.611591176693771*^9, 3.611591180755518*^9}, {
   3.611595521048736*^9, 3.611595521218523*^9}, {3.61159558750632*^9, 
   3.611595595813859*^9}, {3.611595983098118*^9, 3.611596012583907*^9}, {
   3.611596098903285*^9, 3.6115961335126247`*^9}, {3.6115961980482273`*^9, 
   3.6115962288041143`*^9}, {3.6115962650195217`*^9, 3.611596448555397*^9}, {
   3.611596606032537*^9, 3.611596606261241*^9}, {3.611596697633278*^9, 
   3.6115967379469137`*^9}, 3.611596789912765*^9, {3.6115968423281727`*^9, 
   3.6115968428163548`*^9}, {3.611596966503125*^9, 3.6115969935119467`*^9}, {
   3.611597115890562*^9, 3.6115971171643133`*^9}, {3.611597208365424*^9, 
   3.611597256539167*^9}, {3.611597511936282*^9, 3.611597583184329*^9}, {
   3.6115978412310677`*^9, 3.6115978422724752`*^9}, {3.611597987311226*^9, 
   3.611597987466687*^9}, {3.611598264110196*^9, 3.611598270780634*^9}, {
   3.6115983592008877`*^9, 3.611598377879941*^9}, {3.6115987657228823`*^9, 
   3.611598822794331*^9}, {3.611598855317266*^9, 3.6115988648868313`*^9}, {
   3.611598930603713*^9, 3.611598932357829*^9}, {3.611599160763007*^9, 
   3.6115992030272007`*^9}, {3.611599277967334*^9, 3.611599303500646*^9}, {
   3.611599491400936*^9, 3.611599512936102*^9}, {3.611660674213039*^9, 
   3.6116607199549017`*^9}, {3.611660756481393*^9, 3.611660839964183*^9}, {
   3.6116608709634447`*^9, 3.611660873201776*^9}, {3.6116610408558903`*^9, 
   3.611661112129075*^9}, {3.611661160126308*^9, 3.6116611601803427`*^9}, {
   3.611661227454314*^9, 3.611661378968472*^9}, {3.6116614125330133`*^9, 
   3.611661479708746*^9}, {3.611661538322124*^9, 3.611661549027843*^9}, {
   3.611661658727016*^9, 3.611661684883451*^9}, {3.611661717398069*^9, 
   3.611661717523974*^9}, 3.611661833098796*^9, {3.611662444737458*^9, 
   3.6116624481439734`*^9}, {3.6118397667836733`*^9, 3.611839766966201*^9}, {
   3.611916175221781*^9, 3.611916175363654*^9}, {3.613393919500874*^9, 
   3.613393952197991*^9}, {3.613394111317471*^9, 3.6133941122367153`*^9}, 
   3.613394218529497*^9, {3.613394265066018*^9, 3.613394278824181*^9}, {
   3.6133943282475157`*^9, 3.613394340822646*^9}, {3.613394757755076*^9, 
   3.613394757805008*^9}, {3.6133962800692244`*^9, 3.6133963096305857`*^9}, {
   3.613473633823702*^9, 3.6134736574671383`*^9}, {3.613473817633107*^9, 
   3.613473831174222*^9}, {3.614359204102059*^9, 3.614359205088554*^9}, {
   3.6143593056745987`*^9, 3.6143593217415447`*^9}, 3.614359765536119*^9, {
   3.6143598409581413`*^9, 3.614359892453467*^9}, 3.614360030966971*^9, {
   3.614360283918921*^9, 3.614360316152444*^9}, {3.614426089951935*^9, 
   3.6144261086594753`*^9}, {3.614426255504928*^9, 3.6144262576476*^9}, {
   3.614426402757983*^9, 3.614426431420204*^9}, {3.614539614585294*^9, 
   3.614539642773107*^9}, {3.614539968871532*^9, 3.6145399696393337`*^9}, {
   3.6200442571487226`*^9, 3.62004425852544*^9}, {3.62004432600931*^9, 
   3.620044356383872*^9}, {3.6208268798493834`*^9, 3.62082688830991*^9}, {
   3.620987234704566*^9, 3.620987240718379*^9}, {3.631115156996886*^9, 
   3.631115157543784*^9}, {3.631115227653659*^9, 3.631115228372917*^9}, {
   3.631115285687739*^9, 3.631115291627604*^9}, {3.631115346241314*^9, 
   3.631115439971004*^9}, {3.631115506466047*^9, 3.631115509346077*^9}, {
   3.631115555391376*^9, 3.631115556733193*^9}, 3.631115745328678*^9, {
   3.631115797038096*^9, 3.631115797190233*^9}, {3.631115916751617*^9, 
   3.631116081124667*^9}, {3.631139393441118*^9, 3.631139409794036*^9}, 
   3.631139447997198*^9, {3.631139815515779*^9, 3.631139815906361*^9}, {
   3.631139887808552*^9, 3.631139900298494*^9}, 3.631139933827333*^9, {
   3.631140186163731*^9, 3.631140236865359*^9}, 3.631140472403717*^9, {
   3.631140562387259*^9, 3.631140562543602*^9}, {3.631140704700644*^9, 
   3.631140704760833*^9}, {3.631140737320497*^9, 3.631140737378275*^9}, {
   3.631140778720037*^9, 3.631140779465575*^9}, {3.631140839676925*^9, 
   3.631140850991018*^9}, {3.631140938670434*^9, 3.631140941947855*^9}, {
   3.634496375744001*^9, 3.634496376190287*^9}, {3.634496593330241*^9, 
   3.634496629123041*^9}, {3.634496708746545*^9, 3.634496749569228*^9}, {
   3.6344968422576714`*^9, 3.634496842868*^9}, {3.634496903242916*^9, 
   3.634496969327989*^9}, {3.634497052313529*^9, 3.63449712709338*^9}, {
   3.634497334882395*^9, 3.6344974504072647`*^9}, {3.634497506842214*^9, 
   3.634497524747747*^9}, {3.634497556305476*^9, 3.634497561694901*^9}, {
   3.634497818204751*^9, 3.634497828738884*^9}, {3.6344981088007174`*^9, 
   3.634498113488803*^9}, {3.634498155082099*^9, 3.634498174821207*^9}, {
   3.634498350349118*^9, 3.6344983558198853`*^9}, {3.634498461647704*^9, 
   3.634498461923847*^9}, {3.705987001246809*^9, 3.705987088502885*^9}, {
   3.705987407854306*^9, 3.7059874079089603`*^9}, {3.7059874571899223`*^9, 
   3.705987476974595*^9}, 3.70598757408567*^9, {3.705987656019969*^9, 
   3.705987695331761*^9}, {3.7059877264917192`*^9, 3.7059877272992373`*^9}, {
   3.705987916779654*^9, 3.705987924381741*^9}, {3.7059883933918867`*^9, 
   3.705988394743251*^9}, {3.70598859548748*^9, 3.7059886003183613`*^9}, {
   3.7059886988226147`*^9, 3.705988698949046*^9}, {3.705988910468449*^9, 
   3.7059889818354883`*^9}, 3.7059964456568117`*^9, {3.705996537280128*^9, 
   3.705996538270714*^9}, {3.705996581030911*^9, 3.7059965830947027`*^9}, {
   3.70599699726974*^9, 3.7059969977479763`*^9}, {3.705997060557095*^9, 
   3.705997073292531*^9}, {3.705997104771847*^9, 3.70599714486901*^9}, {
   3.705999911926456*^9, 3.705999914180984*^9}, {3.706352663873432*^9, 
   3.706352699423905*^9}, {3.706415158046001*^9, 3.706415197324254*^9}, {
   3.706415340357461*^9, 3.706415345267672*^9}, 3.706415486916546*^9, {
   3.706416129687807*^9, 3.706416158023136*^9}, {3.70641654181422*^9, 
   3.7064166013570347`*^9}, {3.706417825694529*^9, 3.706417829286059*^9}, {
   3.706417979173931*^9, 3.706417984045412*^9}, {3.706418019014573*^9, 
   3.706418019629199*^9}, {3.70641983832605*^9, 3.7064198391399717`*^9}, {
   3.706419870172236*^9, 3.7064198999541187`*^9}, {3.706434801172295*^9, 
   3.706434803465135*^9}, {3.706438329671225*^9, 3.70643841685507*^9}, {
   3.706438448262843*^9, 3.706438664338965*^9}, {3.706438710462438*^9, 
   3.706438758501651*^9}, {3.706438807598186*^9, 3.706439150572845*^9}, {
   3.706439779706255*^9, 3.706439780473487*^9}, {3.706499678748706*^9, 
   3.706499719105825*^9}, {3.7064997552056017`*^9, 3.7064998027524652`*^9}, {
   3.70651233572097*^9, 3.7065123424566393`*^9}, {3.706512385209754*^9, 
   3.706512385256405*^9}, {3.70651243811242*^9, 
   3.706512485090557*^9}},ExpressionUUID->"8008ff23-da4e-425c-af29-\
8632646174e3"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Histogram", "[", "numsp", "]"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{
   "Show", " ", "frequency", " ", "distribution", " ", "of", " ", "the", " ", 
    "number", " ", "of", " ", "persisting", " ", "species", " ", "in", " ", 
    "the", " ", "replicates"}], " ", "*)"}]}]], "Input",
 CellChangeTimes->{{3.7078122249927588`*^9, 
  3.707812288145797*^9}},ExpressionUUID->"54bc7645-6495-4e46-bdb7-\
3fb1d6520062"]
},
WindowSize->{796, 863},
WindowMargins->{{368, Automatic}, {Automatic, 0}},
FrontEndVersion->"11.1 for Mac OS X x86 (32-bit, 64-bit Kernel) (April 18, \
2017)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[557, 20, 492, 8, 74, "Input", "ExpressionUUID" -> \
"ac66ce40-ddf3-434d-8340-5be3f0c2f5b0"],
Cell[1052, 30, 2317, 60, 327, "Input", "ExpressionUUID" -> \
"4b2d2b42-172f-43da-b9e3-ef92b324b14b"],
Cell[3372, 92, 14479, 334, 1237, "Input", "ExpressionUUID" -> \
"e4b5a597-cb9e-4611-89bb-5b4e0b2e6fa4"],
Cell[17854, 428, 1561, 38, 197, "Input", "ExpressionUUID" -> \
"9ed0a9ae-697e-4614-8c9b-557ac14e715c"],
Cell[19418, 468, 22912, 494, 1731, "Input", "ExpressionUUID" -> \
"8008ff23-da4e-425c-af29-8632646174e3"],
Cell[42333, 964, 448, 10, 67, "Input", "ExpressionUUID" -> \
"54bc7645-6495-4e46-bdb7-3fb1d6520062"]
}
]
*)

